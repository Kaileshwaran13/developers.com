<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Daily System</title>

<style>
:root {
  --bg:#070b12;
  --panel:#0e1624;
  --accent:#4fc3ff;
  --accent2:#7cff9a;
  --danger:#ff5f5f;
  --text:#e6f0ff;
  --muted:#9bb0cc;
}
* { box-sizing:border-box; margin:0; padding:0; }

html, body {
  width:100%;
  height:100%;
  font-family:'Times New Roman', Times, serif;
  font-style:italic;
  background:#070b12;
  color:var(--text);
}

.system-container {
  width:100%;
  height:100%;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px 0;
}

.system {
  width:100%;
  max-width:1200px;
  height:95%;
  background:linear-gradient(180deg,#0e1624,#0a111d);
  border:2px solid #1c2a44;
  border-radius:16px;
  box-shadow:0 0 50px rgba(79,195,255,.3), inset 0 0 30px rgba(79,195,255,.1);
  padding:20px;
  display:flex;
  flex-direction:column;
  align-items:center;
  overflow:hidden;
  justify-content:flex-start;
  animation:borderGlow 3s ease-in-out infinite;
}

@keyframes borderGlow {
  0%, 100% { box-shadow:0 0 50px rgba(79,195,255,.3), inset 0 0 30px rgba(79,195,255,.1); }
  50% { box-shadow:0 0 70px rgba(79,195,255,.5), inset 0 0 40px rgba(79,195,255,.2); }
}

h1 {
  font-size:2rem;
  color:var(--accent);
  text-align:center;
  margin-bottom:16px;
  animation:fadeInDown 1s ease, glow 2s ease-in-out infinite;
  text-shadow:0 0 10px rgba(79,195,255,.8), 0 0 20px rgba(79,195,255,.4);
}
@keyframes fadeInDown {
  from {opacity:0; transform:translateY(-30px);}
  to {opacity:1; transform:translateY(0);}
}
@keyframes glow {
  0%, 100% { text-shadow:0 0 10px rgba(79,195,255,.8), 0 0 20px rgba(79,195,255,.4); }
  50% { text-shadow:0 0 20px rgba(79,195,255,1), 0 0 30px rgba(79,195,255,.6); }
}

.status {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(140px,1fr));
  gap:10px;
  margin-bottom:20px;
  width:100%;
}

.card {
  background:linear-gradient(135deg, rgba(20,30,50,.8), rgba(14,22,36,.8));
  border:1.5px solid #1c2a44;
  border-radius:12px;
  padding:12px;
  text-align:center;
  box-shadow:0 0 20px rgba(79,195,255,.2), inset 0 0 10px rgba(79,195,255,.1);
  transition:all 0.3s ease;
}
.card:hover {
  border-color:var(--accent);
  box-shadow:0 0 30px rgba(79,195,255,.4), inset 0 0 15px rgba(79,195,255,.2);
  transform:translateY(-2px);
}
.card .label { font-size:.8rem; color:var(--muted); text-transform:uppercase; letter-spacing:1px; }
.card .value { font-size:1.3rem; margin-top:4px; color:var(--accent); font-weight:bold; text-shadow:0 0 10px rgba(79,195,255,.6); }

.section {
  width:100%;
  margin-bottom:15px;
  border:1px solid #1c2a44;
  border-radius:12px;
  overflow:hidden;
  display:flex;
  flex-direction:column;
}
.section-header {
  background:linear-gradient(90deg, rgba(14,22,36,.8), rgba(20,30,50,.8));
  padding:12px;
  cursor:pointer;
  display:flex;
  justify-content:center;
  align-items:center;
  user-select:none;
  font-weight:bold;
  font-size:1rem;
  text-align:center;
  position:relative;
  box-shadow:0 0 20px rgba(79,195,255,.2), inset 0 0 10px rgba(79,195,255,.05);
  transition:all 0.3s ease;
  color:var(--accent);
}
.section-header:hover {
  box-shadow:0 0 30px rgba(79,195,255,.4), inset 0 0 15px rgba(79,195,255,.1);
  text-shadow:0 0 10px rgba(79,195,255,.8);
}
.section-header span:last-child {
  position:absolute;
  right:12px;
}
.section-content {
  max-height:0;
  overflow:hidden;
  transition:max-height 0.4s ease, padding 0.4s ease;
  display:flex;
  flex-direction:column;
  gap:6px;
  padding:0 12px;
  width:100%;
  box-sizing:border-box;
}
.section-content.open {
  overflow-y:auto;
  padding:12px;
}

.quests {
  display:flex;
  flex-direction:column;
  gap:8px;
  width:100%;
}

.quest {
  background:linear-gradient(135deg, rgba(14,22,36,.9), rgba(20,30,50,.9));
  border:1.5px solid #1c2a44;
  border-radius:12px;
  padding:10px;
  display:flex;
  align-items:center;
  gap:12px;
  transition:all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  user-select:none;
  box-shadow:0 0 15px rgba(79,195,255,.1);
}
.quest:hover {
  border-color:var(--accent);
  box-shadow:0 0 25px rgba(79,195,255,.3), inset 0 0 10px rgba(79,195,255,.1);
  transform:translateX(4px);
}
.quest.done span { opacity:0.6; }
.quest.x2done { 
  background:rgba(255,95,95,.25);
  border-color:var(--danger);
  box-shadow:0 0 16px rgba(255,95,95,.6);
}
.quest.x2done .check.checked {
  background:var(--danger);
  box-shadow:0 0 14px rgba(255,95,95,.8);
}
.quest.dragging { 
  opacity:0.5; 
  transform:scale(0.98);
  background:rgba(79,195,255,.1);
  border-color:var(--accent);
  box-shadow:0 0 20px rgba(79,195,255,.4);
}

.drag-handle {
  cursor:grab;
  user-select:none;
  color:var(--muted);
  font-weight:bold;
  transition:all 0.2s;
}
.quest:hover .drag-handle {
  color:var(--accent);
  transform:scale(1.3);
}
.quest.dragging .drag-handle {
  color:var(--accent2);
  transform:scale(1.5);
}

.check {
  width:24px;
  height:24px;
  border-radius:6px;
  border:2px solid var(--accent);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:all 0.25s;
  flex-shrink:0;
}
.check.checked {
  background:var(--accent);
  box-shadow:0 0 14px rgba(79,195,255,.8);
}
.check.checked::after {
  content:'‚úì';
  color:#000;
  font-weight:700;
  animation:pop .25s ease-out;
}
@keyframes pop {
  from { transform:scale(.3); opacity:0; }
  to { transform:scale(1); opacity:1; }
}

.delete-btn {
  margin-left:auto;
  cursor:pointer;
  color:var(--danger);
  font-weight:bold;
  transition:all 0.2s;
}

.delete-btn:hover {
  text-shadow:0 0 10px rgba(255,95,95,.8);
  transform:scale(1.15);
}

.multiplier-btn {
  margin-left:auto;
  cursor:pointer;
  color:var(--danger);
  font-weight:bold;
  background:linear-gradient(135deg, rgba(255,95,95,.25), rgba(255,95,95,.15));
  border:1.5px solid var(--danger);
  padding:4px 8px;
  border-radius:6px;
  transition:all 0.2s;
  text-shadow:0 0 10px rgba(255,95,95,.8);
  box-shadow:0 0 10px rgba(255,95,95,.2);
}

.multiplier-btn:hover {
  background:linear-gradient(135deg, rgba(255,95,95,.4), rgba(255,95,95,.25));
  box-shadow:0 0 20px rgba(255,95,95,.6), inset 0 0 10px rgba(255,95,95,.2);
  transform:scale(1.05);
  text-shadow:0 0 15px rgba(255,95,95,1);
}

.multiplier-btn:active {
  transform:scale(0.95);
}

/* ‚úÖ NEON GREEN DROP LINE (ADDED) */
.drag-line {
  height:3px;
  background:linear-gradient(90deg, transparent, var(--accent2), transparent);
  box-shadow:0 0 16px rgba(124,255,154,1), inset 0 0 8px rgba(124,255,154,.6);
  border-radius:2px;
  margin:6px 0;
  pointer-events:none;
  animation:pulse-glow 1s ease-in-out infinite;
}

@keyframes pulse-glow {
  0%, 100% { opacity:0.8; box-shadow:0 0 16px rgba(124,255,154,1); }
  50% { opacity:1; box-shadow:0 0 24px rgba(124,255,154,1), inset 0 0 12px rgba(124,255,154,.8); }
}

.footer {
  margin-top:16px;
  text-align:center;
  font-size:.8rem;
  color:var(--muted);
  width:100%;
}
.timeline {
  margin-top:16px;
  font-size:0.9rem;
  color:var(--muted);
  text-align:center;
  width:100%;
  display:flex;
  justify-content:space-between;
}
.timeline div { flex:1; }

.todo-input {
  width:100%;
  display:flex;
  gap:8px;
  margin-bottom:10px;
  box-sizing:border-box;
}
.todo-input input {
  flex:1;
  padding:8px;
  border-radius:6px;
  border:1.5px solid #1c2a44;
  background:linear-gradient(135deg, rgba(14,22,36,.9), rgba(20,30,50,.9));
  color:var(--text);
  box-shadow:0 0 15px rgba(79,195,255,.1), inset 0 0 8px rgba(79,195,255,.05);
  transition:all 0.3s ease;
}

.todo-input input:focus {
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 25px rgba(79,195,255,.3), inset 0 0 10px rgba(79,195,255,.1);
}

.todo-input button {
  padding:8px 14px;
  border-radius:6px;
  border:none;
  background:linear-gradient(135deg, var(--accent), rgba(79,195,255,.8));
  color:#000;
  cursor:pointer;
  font-weight:bold;
  transition:all 0.2s;
  box-shadow:0 0 15px rgba(79,195,255,.3);
}

.todo-input button:hover {
  box-shadow:0 0 25px rgba(79,195,255,.6), inset 0 0 10px rgba(79,195,255,.2);
  transform:translateY(-2px);
}

/* Password overlay */
#passwordOverlay {
  position:fixed;
  inset:0;
  background:black;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:1000;
  flex-direction:column;
}
#passwordOverlay input {
  padding:12px;
  font-size:1.2rem;
  border-radius:8px;
  border:none;
  background:#111;
  color:#fff;
  text-align:center;
  width:220px;
}
#passwordOverlay span {
  color:red;
  margin-top:12px;
  font-size:1rem;
  opacity:0;
  transition:opacity 0.3s;
}

/* ‚ú® CUSTOM SCROLLBAR */
.section-content::-webkit-scrollbar {
  width:10px;
}

.section-content::-webkit-scrollbar-track {
  background:rgba(79,195,255,.05);
  border-radius:10px;
}

.section-content::-webkit-scrollbar-thumb {
  background:linear-gradient(180deg, var(--accent), var(--accent2));
  border-radius:10px;
  box-shadow:0 0 12px rgba(79,195,255,.6);
  border:2px solid rgba(79,195,255,.2);
}

.section-content::-webkit-scrollbar-thumb:hover {
  background:linear-gradient(180deg, var(--accent2), var(--accent));
  box-shadow:0 0 20px rgba(79,195,255,1), inset 0 0 8px rgba(124,255,154,.4);
}

/* Firefox scrollbar */
.section-content {
  scrollbar-color: rgba(79,195,255,.8) rgba(79,195,255,.05);
  scrollbar-width: thin;
}

/* ‚ö° RANK REVEAL OVERLAY */
#rankRevealOverlay {
  position:fixed;
  inset:0;
  background:linear-gradient(135deg, #070b12 0%, #0a111d 50%, #070b12 100%);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:2000;
  backdrop-filter:blur(4px);
  animation:revealFadeIn 0.6s ease-out;
}

@keyframes revealFadeIn {
  from { opacity:0; backdrop-filter:blur(0px); }
  to { opacity:1; backdrop-filter:blur(4px); }
}

.rank-display {
  display:flex;
  justify-content:center;
  align-items:center;
  gap:40px;
}

.stat-item {
  text-align:center;
  animation:statPopUp 0.8s cubic-bezier(0.34, 1.56, 0.64, 1) both;
}

.stat-rank { animation-delay:0s; }

@keyframes statPopUp {
  0% {
    transform:scale(0) rotateZ(-20deg);
    opacity:0;
  }
  50% {
    opacity:1;
  }
  100% {
    transform:scale(1) rotateZ(0deg);
    opacity:1;
  }
}

.stat-value {
  font-weight:bold;
  text-shadow:0 0 80px rgba(79,195,255,.8), 0 0 120px rgba(124,255,154,.4);
  letter-spacing:4px;
  animation:statGlowPulse 1.5s ease-in-out infinite;
  filter:drop-shadow(0 0 40px rgba(79,195,255,.6)) drop-shadow(0 0 60px rgba(124,255,154,.3));
  margin-bottom:12px;
}

.stat-rank .stat-value {
  font-size:12vw;
  background:linear-gradient(135deg, var(--accent), var(--accent2), var(--accent));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

@keyframes statGlowPulse {
  0%, 100% {
    transform:scale(1);
    filter:drop-shadow(0 0 40px rgba(79,195,255,.6)) drop-shadow(0 0 60px rgba(124,255,154,.3));
  }
  50% {
    transform:scale(1.05);
    filter:drop-shadow(0 0 60px rgba(79,195,255,.8)) drop-shadow(0 0 80px rgba(124,255,154,.5));
  }
}

.stat-label {
  font-size:1.5rem;
  letter-spacing:3px;
  color:var(--accent);
  text-shadow:0 0 30px rgba(79,195,255,.8), 0 0 50px rgba(79,195,255,.4);
  font-weight:bold;
  opacity:0.9;
}

@keyframes revealFadeOut {
  0% {
    opacity:1;
    backdrop-filter:blur(4px);
  }
  100% {
    opacity:0;
    backdrop-filter:blur(0px);
    pointer-events:none;
  }
}

/* üéÆ LEVEL UP ANIMATION */
#levelUpOverlay {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:3000;
  backdrop-filter:blur(3px);
}

.levelup-popup {
  text-align:center;
  animation:levelupBurst 1.2s ease-out forwards;
}

@keyframes levelupBurst {
  0% {
    transform:scale(0) rotateZ(-30deg);
    opacity:0;
  }
  40% {
    transform:scale(1.15) rotateZ(10deg);
    opacity:1;
  }
  100% {
    transform:scale(1) rotateZ(0deg);
    opacity:1;
  }
}

.levelup-text {
  font-size:8vw;
  font-weight:bold;
  background:linear-gradient(135deg, #ffff00, #ff6b00, #ff00ff);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  text-shadow:0 0 100px rgba(255,255,0,.8);
  letter-spacing:6px;
  margin-bottom:20px;
  filter:drop-shadow(0 0 50px rgba(255,255,0,.6));
  animation:levelupGlow 1.5s ease-in-out infinite;
}

@keyframes levelupGlow {
  0%, 100% { filter:drop-shadow(0 0 50px rgba(255,255,0,.6)) drop-shadow(0 0 80px rgba(255,100,0,.4)); }
  50% { filter:drop-shadow(0 0 80px rgba(255,255,0,.8)) drop-shadow(0 0 120px rgba(255,100,0,.6)); }
}

.levelup-new {
  font-size:4vw;
  color:var(--accent);
  font-weight:bold;
  animation:slideInUp 0.8s ease-out 0.4s both;
}

@keyframes slideInUp {
  from { transform:translateY(50px); opacity:0; }
  to { transform:translateY(0); opacity:1; }
}

/* üèÜ ACHIEVEMENT BADGE */
.achievement-popup {
  position:fixed;
  top:20px;
  right:20px;
  background:linear-gradient(135deg, rgba(20,30,50,.95), rgba(14,22,36,.95));
  border:2px solid var(--accent2);
  border-radius:12px;
  padding:16px 24px;
  z-index:2500;
  animation:badgeSlideIn 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
  box-shadow:0 0 30px rgba(124,255,154,.6), inset 0 0 15px rgba(124,255,154,.2);
  max-width:300px;
}

@keyframes badgeSlideIn {
  from { transform:translateX(400px); opacity:0; }
  to { transform:translateX(0); opacity:1; }
}

.achievement-title {
  color:var(--accent2);
  font-weight:bold;
  font-size:1rem;
  margin-bottom:4px;
  text-shadow:0 0 10px rgba(124,255,154,.8);
}

.achievement-text {
  color:var(--text);
  font-size:0.9rem;
  opacity:0.9;
}

/* üìä STATUS WINDOW */
.status-btn {
  position:fixed;
  bottom:20px;
  right:20px;
  width:50px;
  height:50px;
  background:linear-gradient(135deg, var(--accent), rgba(79,195,255,.8));
  border:2px solid var(--accent);
  border-radius:50%;
  color:#000;
  font-weight:bold;
  cursor:pointer;
  z-index:1500;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.5rem;
  transition:all 0.3s ease;
  box-shadow:0 0 20px rgba(79,195,255,.6);
}

.status-btn:hover {
  transform:scale(1.1);
  box-shadow:0 0 30px rgba(79,195,255,.8);
}

.status-panel {
  position:fixed;
  bottom:80px;
  right:20px;
  background:linear-gradient(180deg, rgba(14,22,36,.95), rgba(10,17,29,.95));
  border:2px solid var(--accent);
  border-radius:12px;
  padding:20px;
  width:300px;
  z-index:1500;
  box-shadow:0 0 30px rgba(79,195,255,.6);
  max-height:400px;
  overflow-y:auto;
  display:none;
  animation:panelSlideIn 0.4s ease-out;
}

@keyframes panelSlideIn {
  from { opacity:0; transform:translateY(20px); }
  to { opacity:1; transform:translateY(0); }
}

.status-panel.show {
  display:block;
}

.status-row {
  display:flex;
  justify-content:space-between;
  padding:8px 0;
  border-bottom:1px solid rgba(79,195,255,.2);
  color:var(--text);
}

.status-row:last-child {
  border-bottom:none;
}

.status-label {
  color:var(--muted);
  font-size:0.9rem;
}

.status-value {
  color:var(--accent);
  font-weight:bold;
}

/* ü™ü FLOATING WINDOWS */
.floating-window {
  position:fixed;
  width:350px;
  height:450px;
  background:linear-gradient(135deg, rgba(14,22,36,.95), rgba(20,30,50,.95));
  border:2px solid var(--accent);
  border-radius:12px;
  box-shadow:0 0 40px rgba(79,195,255,.6), inset 0 0 20px rgba(79,195,255,.1);
  display:none;
  flex-direction:column;
  z-index:2000;
  animation:windowSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
}

.floating-window.fullscreen {
  width:90vw;
  height:90vh;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
}

.floating-window.normal {
  width:350px;
  height:450px;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
}

@keyframes windowSlideIn {
  from { opacity:0; transform:translate(-50%, -50%) scale(0.8); }
  to { opacity:1; transform:translate(-50%, -50%) scale(1); }
}

@keyframes breathe {
  0%, 100% { box-shadow:0 0 40px rgba(79,195,255,.6), inset 0 0 20px rgba(79,195,255,.1); }
  50% { box-shadow:0 0 60px rgba(79,195,255,.8), inset 0 0 30px rgba(79,195,255,.2); }
}

.floating-window {
  animation:windowSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards, breathe 3s ease-in-out infinite 0.4s !important;
}

.window-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px;
  background:linear-gradient(90deg, rgba(14,22,36,.8), rgba(20,30,50,.8));
  border-bottom:1px solid var(--accent);
  flex-shrink:0;
}

.window-title {
  color:var(--accent);
  font-weight:bold;
  font-size:1.1rem;
  text-shadow:0 0 10px rgba(79,195,255,.8);
}

.window-controls {
  display:flex;
  gap:8px;
}

.window-btn {
  width:32px;
  height:32px;
  border:1px solid var(--accent);
  background:rgba(79,195,255,.1);
  border-radius:6px;
  color:var(--accent);
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:all 0.2s;
  font-weight:bold;
}

.window-btn:hover {
  background:rgba(79,195,255,.3);
  box-shadow:0 0 15px rgba(79,195,255,.6);
  transform:scale(1.1);
}

.window-btn:active {
  transform:scale(0.95);
}

.window-content {
  flex:1;
  overflow-y:auto;
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:8px;
}

.window-content::-webkit-scrollbar {
  width:10px;
}

.window-content::-webkit-scrollbar-track {
  background:rgba(79,195,255,.05);
  border-radius:10px;
}

.window-content::-webkit-scrollbar-thumb {
  background:linear-gradient(180deg, var(--accent), var(--accent2));
  border-radius:10px;
  box-shadow:0 0 12px rgba(79,195,255,.6);
}

.window-content::-webkit-scrollbar-thumb:hover {
  box-shadow:0 0 20px rgba(79,195,255,1);
}

</style>
</head>

<body>

<div id="passwordOverlay">
  <input type="password" id="passwordInput" placeholder="Enter Password" autofocus>
  <span id="pwError">Unauthorized Access</span>
</div>

<div id="levelUpOverlay" style="display:none;">
  <div class="levelup-popup">
    <div class="levelup-text">LEVEL UP!</div>
    <div class="levelup-new">New Level: <span id="newLevelText">2</span></div>
  </div>
</div>

<div id="achievementContainer"></div>

<div class="status-panel" id="statusPanel">
  <div style="color:var(--accent); font-weight:bold; margin-bottom:12px; text-shadow:0 0 10px rgba(79,195,255,.6);">DETAILED STATUS</div>
  <div class="status-row"><span class="status-label">Level:</span><span class="status-value" id="statusLevel">1</span></div>
  <div class="status-row"><span class="status-label">Rank:</span><span class="status-value" id="statusRank">E</span></div>
  <div class="status-row"><span class="status-label">EXP:</span><span class="status-value" id="statusExp">0/100</span></div>
  <div class="status-row"><span class="status-label">Strength:</span><span class="status-value" id="statusStr">0</span></div>
  <div class="status-row"><span class="status-label">Endurance:</span><span class="status-value" id="statusEnd">0</span></div>
  <div class="status-row"><span class="status-label">Soldiers:</span><span class="status-value" id="statusSoldiers">0</span></div>
  <div class="status-row"><span class="status-label">Power:</span><span class="status-value" id="statusPower">0%</span></div>
  <div style="margin-top:12px; padding-top:12px; border-top:1px solid rgba(79,195,255,.2);">
    <div class="power-bar-container">
      <div class="power-bar-fill" id="powerBarFill" style="width:0%;"></div>
    </div>
  </div>
</div>

<div id="rankRevealOverlay" style="display:none;">
  <div class="rank-display">
    <div class="stat-item stat-rank">
      <div class="stat-value" id="rankDisplay">E</div>
      <div class="stat-label">RANK</div>
    </div>
  </div>
</div>

<!-- FLOATING WINDOWS -->
<div id="workoutWindow" class="floating-window normal" style="display:none;">
  <div class="window-header">
    <div class="window-title">WORKOUT</div>
    <div class="window-controls">
      <button class="window-btn" onclick="closeWindow('workoutWindow')">‚úï</button>
    </div>
  </div>
  <div class="window-content" id="workoutContent"></div>
</div>

<div id="todoWindow" class="floating-window normal" style="display:none; bottom:480px; flex-direction:column;">
  <div class="window-header">
    <div class="window-title">TO DO</div>
    <div class="window-controls">
      <button class="window-btn" onclick="closeWindow('todoWindow')">‚úï</button>
    </div>
  </div>
  <div class="window-content" id="todoContentWindow" style="flex:1; overflow-y:auto; padding:12px; display:flex; flex-direction:column;">
    <div id="todoListWindow" class="quests" style="flex:1;"></div>
    <div class="todo-input" style="margin-top:12px; display:flex; gap:8px; flex-shrink:0;">
      <input type="text" id="newTaskWindow" placeholder="Add task..." style="flex:1; padding:6px; border-radius:4px; border:1.5px solid #1c2a44; background:rgba(14,22,36,.8); color:var(--text); box-shadow:0 0 10px rgba(79,195,255,.1);">
      <button id="addBtnWindow" style="padding:6px 10px; border-radius:4px; border:none; background:linear-gradient(135deg, var(--accent), rgba(79,195,255,.8)); color:#000; cursor:pointer; font-weight:bold; box-shadow:0 0 10px rgba(79,195,255,.3); transition:all 0.2s;" onmouseover="this.style.boxShadow='0 0 20px rgba(79,195,255,.6)';" onmouseout="this.style.boxShadow='0 0 10px rgba(79,195,255,.3)';">+</button>
    </div>
  </div>
</div>

<div class="system-container" style="display:none;">
  <div class="system">

    <h1>SYSTEM ‚Äì DAILY QUEST</h1>
    <div class="status">
      <div class="card"><div class="label">LEVEL</div><div id="level" class="value">1</div></div>
      <div class="card"><div class="label">RANK</div><div id="rank" class="value">E</div></div>
      <div class="card"><div class="label">EXP</div><div id="exp" class="value">0 / 100</div></div>
      <div class="card"><div class="label">STRENGTH</div><div id="str" class="value">0</div></div>
      <div class="card"><div class="label">ENDURANCE</div><div id="end" class="value">0</div></div>
    </div>

    <div style="margin-top:30px; display:flex; justify-content:center; flex-direction:column; align-items:stretch; gap:12px; width:100%;">
      <button style="background:linear-gradient(135deg, rgba(79,195,255,.15) 0%, rgba(79,195,255,.05) 100%); color:var(--accent); border:1.5px solid rgba(79,195,255,.4); border-radius:8px; padding:16px 24px; font-size:1.1rem; font-weight:bold; cursor:pointer; transition:all 0.3s; box-shadow:0 0 15px rgba(79,195,255,.2), inset 0 0 8px rgba(79,195,255,.1);" onclick="openWindowFullscreen('workoutWindow')" onmouseover="this.style.boxShadow='0 0 30px rgba(79,195,255,.4), inset 0 0 12px rgba(79,195,255,.2)'; this.style.backgroundColor='rgba(79,195,255,.2)'; this.style.borderColor='rgba(79,195,255,.6)'" onmouseout="this.style.boxShadow='0 0 15px rgba(79,195,255,.2), inset 0 0 8px rgba(79,195,255,.1)'; this.style.backgroundColor='rgba(79,195,255,.05)'; this.style.borderColor='rgba(79,195,255,.4)'">WORKOUT</button>
      <button style="background:linear-gradient(135deg, rgba(124,255,154,.15) 0%, rgba(124,255,154,.05) 100%); color:var(--accent2); border:1.5px solid rgba(124,255,154,.4); border-radius:8px; padding:16px 24px; font-size:1.1rem; font-weight:bold; cursor:pointer; transition:all 0.3s; box-shadow:0 0 15px rgba(124,255,154,.2), inset 0 0 8px rgba(124,255,154,.1);" onclick="openWindowFullscreen('todoWindow')" onmouseover="this.style.boxShadow='0 0 30px rgba(124,255,154,.4), inset 0 0 12px rgba(124,255,154,.2)'; this.style.backgroundColor='rgba(124,255,154,.2)'; this.style.borderColor='rgba(124,255,154,.6)'" onmouseout="this.style.boxShadow='0 0 15px rgba(124,255,154,.2), inset 0 0 8px rgba(124,255,154,.1)'; this.style.backgroundColor='rgba(124,255,154,.05)'; this.style.borderColor='rgba(124,255,154,.4)'">TO DO</button>
    </div>

    <div class="footer">Resets automatically at 00:00</div>
    <div class="timeline">
      <div id="missedStreak">Daily Reset: Active</div>
    </div>

  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const firebaseConfig = {
  projectId: "solo-leveling-36aca",
  databaseURL: "https://solo-leveling-36aca-default-rtdb.firebaseio.com"
};
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const userId = 'defaultUser';

const overlay = document.getElementById('passwordOverlay');
const input = document.getElementById('passwordInput');
const errorMsg = document.getElementById('pwError');

// ========== GLOBAL VARIABLES ==========
let level=1, exp=0, expNeeded=100, str=0, end=0,
    completed=[], streakDays=0, missedDays=0, todoTasks=[], lastResetDate=null, baseMultiplier=1, x2Completed=[], 
    prevLevel=1, weeklyCompletions=0, totalWorkouts=0;

const motivationalQuotes=[
  { text: "Discipline is the bridge between goals and accomplishment", author: "Solo Leveling" },
  { text: "Hunters aren't born. They are made through discipline.", author: "Solo Leveling" },
  { text: "Pain is just weakness leaving the body.", author: "Solo Leveling" },
  { text: "You must never give up, no matter what.", author: "Solo Leveling" },
  { text: "The only way to become stronger is through continuous effort.", author: "Solo Leveling" },
  { text: "Your limit is not the sky, it's your determination.", author: "Solo Leveling" },
  { text: "Every setback is a setup for a comeback.", author: "Solo Leveling" },
  { text: "Success is not final, failure is not fatal.", author: "Solo Leveling" }
];

const baseQuests=[
  ['Push-ups',25,'reps'], ['Sit-ups',25,'reps'], ['Squats',25,'reps'],
  ['Dips',25,'reps'], ['Inverted Rows',25,'reps'], ['Russian Twist',25,'reps'],
  ['Lunges',25,'reps'], ['Arm Presser (Each Side)',100,'reps'],
  ['Plank',1,'mins'], ['Left Side Plank',1,'mins'], ['Right Side Plank',1,'mins'],
  ['Swimming',60,'mins'], ['Cycling / Walking',1,'kms']
];

const dragLine=document.createElement('div');
dragLine.className='drag-line';

// ========== WINDOW FUNCTIONS ==========
window.openWindowFullscreen=function(windowId){
  const win=document.getElementById(windowId);
  win.style.animation='none';
  void win.offsetWidth; // Trigger reflow to reset animation
  win.classList.add('fullscreen');
  win.classList.remove('normal');
  win.style.display='flex';
  win.style.animation='windowSlideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards';
  if(windowId==='todoWindow') {
    buildTodo();
  } else if(windowId==='workoutWindow') {
    buildQuests();
  }
};

window.closeWindow=function(windowId){
  const win=document.getElementById(windowId);
  win.style.opacity='0';
  win.style.transition='opacity 0.3s ease-in';
  setTimeout(()=>{
    win.style.display='none';
    win.style.opacity='1';
    win.style.transition='none';
    win.style.animation='none';
    win.classList.remove('fullscreen');
    win.classList.add('normal');
  }, 300);
};

function toggleStatusPanel(){
  const panel=document.getElementById('statusPanel');
  panel.classList.toggle('show');
}

async function handlePasswordSuccess(){
  overlay.style.display='none';
  const rankOverlay=document.getElementById('rankRevealOverlay');
  rankOverlay.style.display='flex';
  
  setTimeout(()=>{
    rankOverlay.style.animation='revealFadeOut 0.8s ease-in forwards';
    setTimeout(()=>{
      rankOverlay.style.display='none';
      document.querySelector('.system-container').style.display='flex';
    }, 800);
  }, 1800);

  await initSystem();
}

input.addEventListener('keydown', e=>{
  if(e.key==='Enter'){
    if(input.value==='K@ilesh13'){
      handlePasswordSuccess();
    } else {
      errorMsg.style.opacity=1;
    }
  }
});

// ========== HELPER FUNCTIONS ==========
function getRank(totalExp){
  if(totalExp<10000)return'E'; if(totalExp<20000)return'D';
  if(totalExp<30000)return'C'; if(totalExp<40000)return'B';
  if(totalExp<50000)return'A'; if(totalExp<60000)return'S';
  if(totalExp<70000)return'SS'; if(totalExp<80000)return'SSS';
  if(totalExp<90000)return'SSS+'; return'‚àû';
}

function getMultiplier(){
  return (1+(level-1)*0.05)*baseMultiplier;
}

function updateStatusPanel(){
  document.getElementById('statusLevel').textContent=level;
  document.getElementById('statusRank').textContent=getRank(level*10);
  document.getElementById('statusExp').textContent=`${exp}/${expNeeded}`;
  document.getElementById('statusStr').textContent=str;
  document.getElementById('statusEnd').textContent=end;
  document.getElementById('statusSoldiers').textContent=totalWorkouts;
  const power=Math.min(100, Math.floor((completed.length/baseQuests.length)*100));
  document.getElementById('statusPower').textContent=power+'%';
  document.getElementById('powerBarFill').style.width=power+'%';
}

function updateUI(){
  document.getElementById('level').textContent=level;
  document.getElementById('rank').textContent=getRank(level*10);
  document.getElementById('exp').textContent=`${exp} / ${expNeeded}`;
  document.getElementById('str').textContent=str;
  document.getElementById('end').textContent=end;
}

function showAchievement(title, text){
  const container=document.getElementById('achievementContainer');
  const badge=document.createElement('div');
  badge.className='achievement-popup';
  badge.innerHTML=`<div class="achievement-title">üèÜ ${title}</div><div class="achievement-text">${text}</div>`;
  container.appendChild(badge);
  setTimeout(()=>{
    badge.remove();
  }, 4000);
}

function checkAchievements(){
  if(completed.length===5 && !localStorage.getItem('ach_warrior')){
    localStorage.setItem('ach_warrior','true');
    showAchievement('Warrior', 'Complete 5 workouts!');
  }
  if(level*10>=500 && !localStorage.getItem('ach_veteran')){
    localStorage.setItem('ach_veteran','true');
    showAchievement('Veteran', 'Reach 500 EXP!');
  }
}

// ========== QUEST FUNCTIONS ==========
function buildQuests(){
  const wrap=document.getElementById('workoutContent');
  wrap.innerHTML='';
  const m=getMultiplier();
  baseQuests.forEach(([name,val,type])=>{
    let display=name==='Swimming'?val:Math.round(val*m);
    
    let displayText;
    if(type==='mins'){
      const totalSeconds=Math.round(display*60);
      const mins=Math.floor(totalSeconds/60);
      const secs=totalSeconds%60;
      displayText=`${mins}m ${secs}s`;
    }else{
      displayText=`${display} ${type}`;
    }
    
    const q=document.createElement('div');
    const isX2=x2Completed.includes(name);
    const isDone=completed.includes(name);
    q.className='quest'+(isDone?' done':'')+(isX2?' x2done':'');
    q.dataset.name=name;
    q.innerHTML=
      `<div class="check ${isDone?'checked':''}" onclick="toggleQuest(this)"></div>
       <span>${name} ‚Äì ${displayText}</span>
       <button class="multiplier-btn" onclick="toggleQuestX2(event)">√ó2</button>`;
    wrap.appendChild(q);
  });
}

window.toggleQuest=function(box){
  const quest=box.parentElement;
  const name=quest.dataset.name;
  if(completed.includes(name) && !x2Completed.includes(name)) return;
  if(x2Completed.includes(name)) return;
  completed.push(name);
  totalWorkouts++;
  weeklyCompletions++;
  if(name!=='Swimming'){ str++; end++; exp+=10; }
  prevLevel=level;
  if(exp>=expNeeded){ level++; exp=0; expNeeded=Math.floor(expNeeded*1.3); }
  saveData(); buildQuests(); updateUI(); updateStatusPanel(); checkAchievements();
};

window.toggleQuestX2=function(e){
  e.preventDefault();
  e.stopPropagation();
  const quest=e.target.parentElement;
  const name=quest.dataset.name;
  
  if(x2Completed.includes(name)) return;
  
  const wasNormalCompleted=completed.includes(name) && !x2Completed.includes(name);
  
  if(wasNormalCompleted){
    if(name!=='Swimming'){ str+=1; end+=1; exp+=10; }
  }else{
    completed.push(name);
    totalWorkouts++;
    weeklyCompletions++;
    if(name!=='Swimming'){ str+=2; end+=2; exp+=20; }
  }
  
  x2Completed.push(name);
  
  prevLevel=level;
  if(exp>=expNeeded){ level++; exp=0; expNeeded=Math.floor(expNeeded*1.3); }
  saveData(); buildQuests(); updateUI(); updateStatusPanel(); checkAchievements();
};

// ========== TODO FUNCTIONS ==========
let draggedIndex=-1;

function autoExpandTodo(){
  const el=document.getElementById('todoListWindow');
  if(el) el.style.maxHeight=el.scrollHeight+'px';
}

function buildTodo(){
  const list=document.getElementById('todoListWindow');
  if(!list) return;
  list.innerHTML='';
  todoTasks.forEach((task,index)=>{
    const div=document.createElement('div');
    div.className='quest';
    div.draggable=true;
    div.dataset.index=index;

    div.innerHTML=`
      <span class="drag-handle">::</span>
      <div class="check ${task.done?'checked':''}"></div>
      <span>${task.text}</span>
      <span class="delete-btn">‚úï</span>
    `;

    div.querySelector('.check').onclick=(e)=>{
      const checkEl=e.target;
      task.done=!task.done;
      checkEl.classList.toggle('checked');
      div.classList.toggle('done');
      saveData();
    };
    div.querySelector('.delete-btn').onclick=()=>{
      todoTasks.splice(index,1); saveData(); buildTodo();
    };

    div.addEventListener('dragstart',e=>{
      draggedIndex=index;
      e.dataTransfer.effectAllowed='move';
      setTimeout(()=>div.classList.add('dragging'),0);
    });
    
    div.addEventListener('dragend',()=>{
      div.classList.remove('dragging');
      draggedIndex=-1;
      dragLine.remove();
    });
    
    div.addEventListener('dragover',e=>{
      if(draggedIndex===-1) return;
      e.preventDefault();
      e.dataTransfer.dropEffect='move';
      dragLine.remove();
      const rect=div.getBoundingClientRect();
      const isBottom=e.clientY-rect.top>rect.height/2;
      const currentIndex=parseInt(div.dataset.index);
      if(draggedIndex!==currentIndex){
        isBottom?div.after(dragLine):div.before(dragLine);
      }
    });
    
    div.addEventListener('drop',e=>{
      e.preventDefault();
      const from=draggedIndex;
      const to=parseInt(div.dataset.index);
      
      if(from===-1 || from===to) return;
      
      const moved=todoTasks.splice(from,1)[0];
      todoTasks.splice(to,0,moved);
      
      saveData();
      buildTodo();
    });

    list.appendChild(div);
  });
}

// ========== DATA FUNCTIONS ==========
async function loadData(){
  const snap=await get(ref(db,'users/'+userId));
  const d=snap.val();
  if(d){
    level=d.level||1; exp=d.exp||0; expNeeded=d.expNeeded||100;
    str=d.str||0; end=d.end||0; completed=d.completed||[];
    streakDays=d.streakDays||0; missedDays=d.missedDays||0;
    todoTasks=d.todoTasks||[]; lastResetDate=d.lastResetDate||null;
    baseMultiplier=d.baseMultiplier||1; x2Completed=d.x2Completed||[];
    totalWorkouts=d.totalWorkouts||0; prevLevel=level;
  }
  const rank=getRank(level*10);
  document.getElementById('rankDisplay').textContent=rank;
  buildQuests(); buildTodo(); updateUI(); updateStatusPanel();
}

function saveData(){
  set(ref(db,'users/'+userId),
    {level,exp,expNeeded,str,end,completed,streakDays,missedDays,todoTasks,lastResetDate,baseMultiplier,x2Completed,totalWorkouts,weeklyCompletions});
}

// ========== INIT SYSTEM ==========
async function initSystem(){
  const addBtnWindow=document.getElementById('addBtnWindow');
  const newTaskWindow=document.getElementById('newTaskWindow');
  
  if(addBtnWindow && newTaskWindow){
    addBtnWindow.onclick=()=>{
      const v=newTaskWindow.value.trim();
      if(!v) return;
      todoTasks.push({text:v,done:false});
      newTaskWindow.value='';
      saveData(); buildTodo();
    };

    newTaskWindow.addEventListener('keydown',e=>{
      if(e.key==='Enter'){
        addBtnWindow.click();
      }
    });
  }

  await loadData();
}
</script>
</body>
</html>
